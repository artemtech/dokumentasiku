<!doctype html><html lang=en-us><head><link rel=preload href=/dokumentasiku/lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/dokumentasiku/lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/dokumentasiku/lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=/dokumentasiku/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Perjalanan K8s Ku (bagian 1) | Dokumentasi Artemtech</title><link rel=canonical href=https://artemtech.github.io/dokumentasiku/posts/perjalanan-k8s-ku-bagian-1/><meta name=description content="Laman ini merupakan dokumentasi keseharian terkait hasil ngoprek dan sidik gangguan atas permasalahan yang saya alami."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Perjalanan K8s Ku (bagian 1)"><meta property="og:description" content="Ah, kubernetes, akhirnya&mldr;
Setelah beberapa waktu yang lalu masih mainan arus deras dengan docker-swarm, kini tiba saatnya untuk menjelajahi lautan luas dengan kubernetes.
Perkakas yang digunakan untuk menyelami luasnya lautan di kubernetes adalah kubectl (saya kubu pembaca: ku-be-ce-te-el :) )
Berikut adalah yang sudah saya pelajari
Daftar Resource:
node -> list node yang tergabung dalam cluster kubernetes pod -> unit terkecil di k8s deployment -> terdiri dari banyak pod daemonset -> terdiri dari banyak pod yang auto tersebar masing-masing 1 pod di tiap node service -> sebagai loadbalancer dari beberapa pod yang ada ingress -> sebagai gerbang masuk dari eksternal host/path menuju internal service-service di dalam kubernetes statefulset job cronjob serviceaccount role rolebinding clusterrole clusterrolebinding Add Resources Sebelum kita bikin resource baru, alangkah baiknya kalau dicek terlebih dahulu apakah sintaksnya sudah benar atau belum dengan menambahkan flag --dry-run=client di akhir command."><meta property="og:type" content="article"><meta property="og:url" content="https://artemtech.github.io/dokumentasiku/posts/perjalanan-k8s-ku-bagian-1/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-09-04T22:33:39+07:00"><meta property="article:modified_time" content="2022-09-04T22:33:39+07:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Perjalanan K8s Ku (bagian 1)"><meta name=twitter:description content="Ah, kubernetes, akhirnya&mldr;
Setelah beberapa waktu yang lalu masih mainan arus deras dengan docker-swarm, kini tiba saatnya untuk menjelajahi lautan luas dengan kubernetes.
Perkakas yang digunakan untuk menyelami luasnya lautan di kubernetes adalah kubectl (saya kubu pembaca: ku-be-ce-te-el :) )
Berikut adalah yang sudah saya pelajari
Daftar Resource:
node -> list node yang tergabung dalam cluster kubernetes pod -> unit terkecil di k8s deployment -> terdiri dari banyak pod daemonset -> terdiri dari banyak pod yang auto tersebar masing-masing 1 pod di tiap node service -> sebagai loadbalancer dari beberapa pod yang ada ingress -> sebagai gerbang masuk dari eksternal host/path menuju internal service-service di dalam kubernetes statefulset job cronjob serviceaccount role rolebinding clusterrole clusterrolebinding Add Resources Sebelum kita bikin resource baru, alangkah baiknya kalau dicek terlebih dahulu apakah sintaksnya sudah benar atau belum dengan menambahkan flag --dry-run=client di akhir command."><link rel=stylesheet href=https://artemtech.github.io/dokumentasiku/css/styles.7c754dee4bfc873743b12288cf94eadcfd3bee1f2cff5a106753b8047879ac5195c8d8ad90f6d73f12e9c841696c51a0abdeae8394e3eb3079f310f418ddf9ec.css integrity="sha512-fHVN7kv8hzdDsSKIz5Tq3P077h8s/1oQZ1O4BHh5rFGVyNitkPbXPxLpyEFpbFGgq96ug5Tj6zB58xD0GN357A=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://artemtech.github.io/dokumentasiku/images/favicon.ico></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul><li><a href=/dokumentasiku/>home</a></li><li><a href=https://artemtechblog.wordpress.com>legacy-blog</a></li><li><a href=/dokumentasiku/about>tentang</a></li></ul></span><br><span id=actions><ul><li><a class=icon href=https://artemtech.github.io/dokumentasiku/about/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://artemtech.github.io/dokumentasiku/posts/juju-mendaftarkan-ssh-keys-tambahan/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&text=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&title=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&is_video=false&description=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Perjalanan%20K8s%20Ku%20%28bagian%201%29&body=Check out this article: https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&title=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&title=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&name=Perjalanan%20K8s%20Ku%20%28bagian%201%29&description=Ah%2c%20kubernetes%2c%20akhirnya%26hellip%3b%0aSetelah%20beberapa%20waktu%20yang%20lalu%20masih%20mainan%20arus%20deras%20dengan%20docker-swarm%2c%20kini%20tiba%20saatnya%20untuk%20menjelajahi%20lautan%20luas%20dengan%20kubernetes.%0aPerkakas%20yang%20digunakan%20untuk%20menyelami%20luasnya%20lautan%20di%20kubernetes%20adalah%20kubectl%20%28saya%20kubu%20pembaca%3a%20ku-be-ce-te-el%20%3a%29%20%29%0aBerikut%20adalah%20yang%20sudah%20saya%20pelajari%0aDaftar%20Resource%3a%0anode%20-%26gt%3b%20list%20node%20yang%20tergabung%20dalam%20cluster%20kubernetes%20pod%20-%26gt%3b%20unit%20terkecil%20di%20k8s%20deployment%20-%26gt%3b%20terdiri%20dari%20banyak%20pod%20daemonset%20-%26gt%3b%20terdiri%20dari%20banyak%20pod%20yang%20auto%20tersebar%20masing-masing%201%20pod%20di%20tiap%20node%20service%20-%26gt%3b%20sebagai%20loadbalancer%20dari%20beberapa%20pod%20yang%20ada%20ingress%20-%26gt%3b%20sebagai%20gerbang%20masuk%20dari%20eksternal%20host%2fpath%20menuju%20internal%20service-service%20di%20dalam%20kubernetes%20statefulset%20job%20cronjob%20serviceaccount%20role%20rolebinding%20clusterrole%20clusterrolebinding%20Add%20Resources%20Sebelum%20kita%20bikin%20resource%20baru%2c%20alangkah%20baiknya%20kalau%20dicek%20terlebih%20dahulu%20apakah%20sintaksnya%20sudah%20benar%20atau%20belum%20dengan%20menambahkan%20flag%20--dry-run%3dclient%20di%20akhir%20command." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&t=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#add-resources>Add Resources</a></li><li><a href=#modify-resources>Modify Resources</a></li><li><a href=#get-resources>Get Resources</a></li><li><a href=#log-tracing>Log tracing</a></li><li><a href=#delete-resources>Delete Resources</a><ul><li><a href=#delete-evicted-pods>Delete Evicted pods</a></li></ul></li><li><a href=#node-operations>Node Operations</a><ul><li><a href=#taint-dan-untaint>Taint dan Untaint</a></li><li><a href=#cordondrain-dan-uncordon>Cordon/Drain dan Uncordon</a></li></ul></li><li><a href=#misc>MISC</a><ul><li><a href=#cek-mtu-semua-pod-dalam-satu-cluster>cek mtu semua pod dalam satu cluster</a></li></ul></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Perjalanan K8s Ku (bagian 1)</h1><div class=meta><div class=postdate><time datetime="2022-09-04 22:33:39 +0700 +0700" itemprop=datePublished>2022-09-04</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=/tags/kubernetes rel=tag>kubernetes</a>
,
<a class=tag-link href=/tags/k8s rel=tag>k8s</a>
,
<a class=tag-link href=/tags/kubectl rel=tag>kubectl</a></div></div></header><div class=content itemprop=articleBody><p>Ah, kubernetes, akhirnya&mldr;<br>Setelah beberapa waktu yang lalu masih mainan arus deras dengan docker-swarm, kini tiba saatnya untuk menjelajahi lautan luas dengan kubernetes.</p><p>Perkakas yang digunakan untuk menyelami luasnya lautan di kubernetes adalah kubectl (saya kubu pembaca: <code>ku-be-ce-te-el</code> :) )</p><p>Berikut adalah yang sudah saya pelajari</p><p><strong>Daftar Resource:</strong></p><ul><li>node -> list node yang tergabung dalam cluster kubernetes</li><li>pod -> unit terkecil di k8s</li><li>deployment -> terdiri dari banyak pod</li><li>daemonset -> terdiri dari banyak pod yang auto tersebar masing-masing 1 pod di tiap node</li><li>service -> sebagai loadbalancer dari beberapa pod yang ada</li><li>ingress -> sebagai gerbang masuk dari eksternal host/path menuju internal service-service di dalam kubernetes</li><li>statefulset</li><li>job</li><li>cronjob</li><li>serviceaccount</li><li>role</li><li>rolebinding</li><li>clusterrole</li><li>clusterrolebinding</li></ul><h2 id=add-resources>Add Resources</h2><p>Sebelum kita bikin resource baru, alangkah baiknya kalau dicek terlebih dahulu apakah sintaksnya sudah
benar atau belum dengan menambahkan flag <code>--dry-run=client</code> di akhir command. Jika kita bikin resource
dengan cara ngecer, misal bikin 1 pod pakai kubectl run, dan ingin menyimpan yaml nya untuk disunting di lain
waktu, gunakan flag <code>-o yaml</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># pod</span>
</span></span><span style=display:flex><span>kubectl run nama_pod -n nama_namespace --image<span style=color:#f92672>=</span>nginx:1.19
</span></span><span style=display:flex><span><span style=color:#75715e># pod (dry-run) ---&gt; tidak akan benar-benar dibikin, tapi cuma simulasi apakah nanti sukses atau tidak</span>
</span></span><span style=display:flex><span>kubectl run nama_pod -n nama_namespace --image<span style=color:#f92672>=</span>nginx:1.19 --dry-run<span style=color:#f92672>=</span>client
</span></span><span style=display:flex><span><span style=color:#75715e># pod (dry-run dan disimpan dalam yaml)</span>
</span></span><span style=display:flex><span>kubectl run nama_pod -n nama_namespace --image<span style=color:#f92672>=</span>nginx:1.19 --dry-run<span style=color:#f92672>=</span>client -o yaml &gt; nama_pod.yaml
</span></span><span style=display:flex><span><span style=color:#75715e># deployment dengan pod memiliki 2 container</span>
</span></span><span style=display:flex><span>kubectl create deployment nama_deployment -n nama_namespace --image<span style=color:#f92672>=</span>nginx:1.19 --image<span style=color:#f92672>=</span>busybox:3.25
</span></span><span style=display:flex><span><span style=color:#75715e># expose deployment sebagai service</span>
</span></span><span style=display:flex><span>kubectl expose deployment nama_deployment -n nama_namespace --name nama_service
</span></span><span style=display:flex><span><span style=color:#75715e># expose pod sebagai service</span>
</span></span><span style=display:flex><span>kubectl expose pod nama_pod -n nama_namespace --name nama_service
</span></span><span style=display:flex><span><span style=color:#75715e># serviceaccount</span>
</span></span><span style=display:flex><span>kubectl create serviceaccount nama_service_account -n nama_namespace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># membuat resource dari file</span>
</span></span><span style=display:flex><span>kubectl apply -f nama_file.yaml
</span></span></code></pre></div><h2 id=modify-resources>Modify Resources</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl edit nama_resource -n nama_namespace
</span></span></code></pre></div><h2 id=get-resources>Get Resources</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># format:</span>
</span></span><span style=display:flex><span>kubectl get nama_resource -n nama_namespace nama_objek
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># list all</span>
</span></span><span style=display:flex><span>kubectl get all -n nama_namespace
</span></span><span style=display:flex><span><span style=color:#75715e># list semua pod yang ada di 1 namespace dengan informasi yang diperluas</span>
</span></span><span style=display:flex><span>kubectl get pod -n nama_namespace -o wide
</span></span><span style=display:flex><span><span style=color:#75715e># list semua pod semua namespace dengan informasi yang diperluas</span>
</span></span><span style=display:flex><span>kubectl get pod -A -o wide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl describe nama_resource -n nama_namespace nama_objek
</span></span></code></pre></div><h2 id=log-tracing>Log tracing</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># melihat event yang terjadi</span>
</span></span><span style=display:flex><span>kubectl get events -n nama_namespace
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># melihat status pod  dan lokasi node nya</span>
</span></span><span style=display:flex><span>kubectl get pod -n nama_namespace -o wide | grep katakunci
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># melihat log pod/deployment/service</span>
</span></span><span style=display:flex><span>kubectl logs -n nama_namespace pod/nama_pod --tail<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span> --timestamps
</span></span><span style=display:flex><span>kubectl logs -n nama_namespace deployment/nama_pod --tail<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span> --timestamps
</span></span><span style=display:flex><span>kubectl logs -n nama_namespace service/nama_pod --tail<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span> --timestamps
</span></span><span style=display:flex><span><span style=color:#75715e># berdasar label app=testing (ambil dari describe bagian label)</span>
</span></span><span style=display:flex><span>kubectl logs -n nama_namespace -l app<span style=color:#f92672>=</span>testing --tail<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span> --timestamps
</span></span></code></pre></div><h2 id=delete-resources>Delete Resources</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># format</span>
</span></span><span style=display:flex><span>kubectl delete nama_resource -n nama_namespace nama_objek
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># contoh:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pod</span>
</span></span><span style=display:flex><span>kubectl delete pod -n nama_namespace nama_pod
</span></span><span style=display:flex><span><span style=color:#75715e># deployment</span>
</span></span><span style=display:flex><span>kubectl delete deployment -n nama_namespace nama_deployment
</span></span><span style=display:flex><span><span style=color:#75715e># service</span>
</span></span><span style=display:flex><span>kubectl delete service -n nama_namespace nama_deployment
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># delete resource dari file</span>
</span></span><span style=display:flex><span>kubectl delete -f nama_file.yaml
</span></span></code></pre></div><h3 id=delete-evicted-pods>Delete Evicted pods</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pods<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get pod -A | grep Evicted | awk <span style=color:#e6db74>&#39;{print $1,$2}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> delpod in $pods
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    ns<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $delpod | cut -d <span style=color:#e6db74>&#39;,&#39;</span> -f 1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>    p<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $delpod | cut -d <span style=color:#e6db74>&#39;,&#39;</span> -f 2<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>    kubectl -n $ns delete pod $p
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><h2 id=node-operations>Node Operations</h2><h3 id=taint-dan-untaint>Taint dan Untaint</h3><p>Taint untuk membatasi node untuk tidak melakukan aksi tertentu jika
pod tidak memiliki toleransi pada node yang memiliki label_node tertentu.<br>Untaint untuk melepaskan taint pada node.<br>Daftar Taint:</p><ul><li>NoSchedule</li><li>NoExecute</li><li>???</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># taint</span>
</span></span><span style=display:flex><span>kubectl taint node nama_node label_node:NoSchedule
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># untaint (tambahkan dash di belakang)</span>
</span></span><span style=display:flex><span>kubectl taint node nama_node label_node:NoSchedule-
</span></span></code></pre></div><h3 id=cordondrain-dan-uncordon>Cordon/Drain dan Uncordon</h3><p>Cordon berarti tidak akan ada scheduling baru pada node. Ini berbeda dengan drain,
kalau kita drain, maka semua pod akan ditendang dari node yang di-drain, setelah itu,
node tidak akan menerima scheduling pod.<br>;tldr:</p><ul><li>drain = tendang semua pod existing di node + set noschedule pod baru</li><li>cordon = set noschedule pod baru</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># cordon</span>
</span></span><span style=display:flex><span>kubectl cordon nama_node
</span></span><span style=display:flex><span><span style=color:#75715e># uncordon</span>
</span></span><span style=display:flex><span>kubectl uncordon nama_node
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># drain</span>
</span></span><span style=display:flex><span>kubectl drain nama_node
</span></span><span style=display:flex><span><span style=color:#75715e># undrain (pakai uncordon, tidak ada perintah undrain)</span>
</span></span><span style=display:flex><span>kubectl uncordon nama_node
</span></span></code></pre></div><h2 id=misc>MISC</h2><h3 id=cek-mtu-semua-pod-dalam-satu-cluster>cek mtu semua pod dalam satu cluster</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>PODS<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>kubectl get pod -A --no-headers --template <span style=color:#e6db74>&#39;{{ range .items }}{{ printf &#34;%s,%s\n&#34; .metadata.namespace .metadata.name }}{{ end }}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> pod in <span style=color:#e6db74>${</span>PODS[@]<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>    ns<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $pod | cut -d <span style=color:#e6db74>&#39;,&#39;</span> -f 1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>    p<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $pod | cut -d <span style=color:#e6db74>&#39;,&#39;</span> -f 2<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>    echo -n <span style=color:#e6db74>&#34;</span>$ns<span style=color:#e6db74>/</span>$p<span style=color:#e6db74> mtu: &#34;</span>
</span></span><span style=display:flex><span>    kubectl -n $ns exec $p -- cat /sys/class/net/eth0/mtu 
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div></div></article><div class=blog-post-comments><div id=disqus_thread><script type=text/javascript>(function(){var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="gh-artemtech-dokumentasiku",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com/ class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul><li><a href=/dokumentasiku/>home</a></li><li><a href=https://artemtechblog.wordpress.com>legacy-blog</a></li><li><a href=/dokumentasiku/about>tentang</a></li></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#add-resources>Add Resources</a></li><li><a href=#modify-resources>Modify Resources</a></li><li><a href=#get-resources>Get Resources</a></li><li><a href=#log-tracing>Log tracing</a></li><li><a href=#delete-resources>Delete Resources</a><ul><li><a href=#delete-evicted-pods>Delete Evicted pods</a></li></ul></li><li><a href=#node-operations>Node Operations</a><ul><li><a href=#taint-dan-untaint>Taint dan Untaint</a></li><li><a href=#cordondrain-dan-uncordon>Cordon/Drain dan Uncordon</a></li></ul></li><li><a href=#misc>MISC</a><ul><li><a href=#cek-mtu-semua-pod-dalam-satu-cluster>cek mtu semua pod dalam satu cluster</a></li></ul></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&text=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&title=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&is_video=false&description=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Perjalanan%20K8s%20Ku%20%28bagian%201%29&body=Check out this article: https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&title=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&title=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&name=Perjalanan%20K8s%20Ku%20%28bagian%201%29&description=Ah%2c%20kubernetes%2c%20akhirnya%26hellip%3b%0aSetelah%20beberapa%20waktu%20yang%20lalu%20masih%20mainan%20arus%20deras%20dengan%20docker-swarm%2c%20kini%20tiba%20saatnya%20untuk%20menjelajahi%20lautan%20luas%20dengan%20kubernetes.%0aPerkakas%20yang%20digunakan%20untuk%20menyelami%20luasnya%20lautan%20di%20kubernetes%20adalah%20kubectl%20%28saya%20kubu%20pembaca%3a%20ku-be-ce-te-el%20%3a%29%20%29%0aBerikut%20adalah%20yang%20sudah%20saya%20pelajari%0aDaftar%20Resource%3a%0anode%20-%26gt%3b%20list%20node%20yang%20tergabung%20dalam%20cluster%20kubernetes%20pod%20-%26gt%3b%20unit%20terkecil%20di%20k8s%20deployment%20-%26gt%3b%20terdiri%20dari%20banyak%20pod%20daemonset%20-%26gt%3b%20terdiri%20dari%20banyak%20pod%20yang%20auto%20tersebar%20masing-masing%201%20pod%20di%20tiap%20node%20service%20-%26gt%3b%20sebagai%20loadbalancer%20dari%20beberapa%20pod%20yang%20ada%20ingress%20-%26gt%3b%20sebagai%20gerbang%20masuk%20dari%20eksternal%20host%2fpath%20menuju%20internal%20service-service%20di%20dalam%20kubernetes%20statefulset%20job%20cronjob%20serviceaccount%20role%20rolebinding%20clusterrole%20clusterrolebinding%20Add%20Resources%20Sebelum%20kita%20bikin%20resource%20baru%2c%20alangkah%20baiknya%20kalau%20dicek%20terlebih%20dahulu%20apakah%20sintaksnya%20sudah%20benar%20atau%20belum%20dengan%20menambahkan%20flag%20--dry-run%3dclient%20di%20akhir%20command." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fartemtech.github.io%2fdokumentasiku%2fposts%2fperjalanan-k8s-ku-bagian-1%2f&t=Perjalanan%20K8s%20Ku%20%28bagian%201%29" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2023 Dokumentasi Artemtech</div><div class=footer-right><nav><ul><li><a href=/dokumentasiku/>home</a></li><li><a href=https://artemtechblog.wordpress.com>legacy-blog</a></li><li><a href=/dokumentasiku/about>tentang</a></li></ul></nav></div></footer></div></body><link rel=stylesheet href=/dokumentasiku/lib/font-awesome/css/all.min.css><script src=/dokumentasiku/lib/jquery/jquery.min.js></script>
<script src=/dokumentasiku/js/main.js></script>
<script src=/dokumentasiku/js/code-copy.js></script></html>